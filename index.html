<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Zork Clone</title>
		<style type="text/css">
			.clickableLI {
				cursor: pointer;
			}
		</style>
	</head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	
	<body onload="setUp()">
		<p id="locationInfo"></p>
		<strong><p id="info" style="color: red"></p></strong>
		<p>Nearby Items:</p>
		<ul id="nearbyItems"></ul>
		<p>Inventory:</p>
		<ul id="inventoryInfo"></ul>
		
		
		<script>
			function item(name, actions)
			{
				this.name = name; //must be unique
				this.actions = actions; //dictionary of action names and functions
			}
			
			function mapLocation(name, items, actions, travelLocations)
			{
				this.name = name;
				this.items = items; //array items in the location
				this.actions = actions; //dictionary of action names and functions
				this.travelLocations = travelLocations; //locations accessible from this locations
			}
			
			var currentLocation;
			var inventory = []; //all the items that you're carrying
			var map = []; //all of the locations in the game
			
			function setUp()
			{
				inventory = [inventoryAxe];
				map = [forestClearing];
				
				enterLocation("Forest Clearing");
			}
			
			function enterLocation(locationName)
			{
				$('#locationInfo').html(
					"Location: " + locationName
				);
				
				for (let i = 0; i < map.length; i++)
				{
					if (map[i].name == locationName)
					{
						currentLocation = map[i];
						i = map.length;
					}
				}
				
				$('#nearbyItems').html('');
				for (let i = 0; i < currentLocation.items.length; i++)
				{
					var item = currentLocation.items[i];
					$('#nearbyItems').html(
						$('#nearbyItems').html() + "<li>" + getItemHTML(item)
					);
				}
				
				$('#inventoryInfo').html('');
				for (let i = 0; i < inventory.length; i++)
				{
					var item = inventory[i];
					$('#inventoryInfo').html(
						$('#inventoryInfo').html() + "<li>" + getItemHTML(item)
					);
				}
			}
			
			function reloadLocation()
			{
				enterLocation(currentLocation.name);
			}
			
			function getItemHTML(item)
			{
				var itemHTML = item.name;
				if (item.actions.length > 0)
				{
					var itemActionListHTML = getItemActionListHTML(item);
					itemHTML += itemActionListHTML;
				}
				return itemHTML;
			}
			
			function getItemActionListHTML(item)
			{
				var itemActionListHTML = "<ul>";
				for (let i = 0; i < item.actions.length; i++)
				{
					var action = item.actions[i];
					var actionName = action[0];
					var actionFunction = action[1];
					var actionHTML = "<li class='clickableLI' onclick='(" + actionFunction + ")();'>" + actionName + "</li>";
					itemActionListHTML += actionHTML;
				}
				itemActionListHTML += "</ul>";
				return itemActionListHTML;
			}
			
			function showMessage(message)
			{
				$('#info').html(message);
			}
			
			//Items
			var inventoryAxe = new item(
				"Axe", 
				[
					["Drop", function() 
						{
							currentLocation.items.push(nearbyAxe);
							inventory.splice(inventory.indexOf(inventoryAxe), 1);
							showMessage("You drop your axe.");
							reloadLocation();
						}
					]
				]
			);
			
			var nearbyAxe = new item(
				"Axe",
				[
					["Pick up", function() 
						{
							currentLocation.items.splice(currentLocation.items.indexOf(nearbyAxe), 1);
							inventory.push(inventoryAxe);
							showMessage("You pick up an axe.");
							reloadLocation();
						}
					]
				]
			);
			
			//Locations
			var forestClearing = new mapLocation(
				"Forest Clearing",
				[],
				[],
				[]
			);
			
		</script>
	</body>
</html>
